<table border="1" ><tr>
<td colspan="2" rowspan="1">计算机硬件</td>
</tr><tr>
<td colspan="1" rowspan="1">历年真题考情：本章节19-21年没考过，但在22年真题考过磁盘调度，根据趋势，以后考的概率很小。第二版更新：第二版教材改版后在2.2增加了这块内容，但是内容很少很少，只有基础的硬件组成介绍，因此我们根据历年真题考察情况做了调整。相比较原来视频，删除了不考的编码、海明码等内容，同时将可靠性独立到可靠性章节。学员看到课件编号不连续无需疑问，是有删减的，按我们最新视频学习即可。文老师软考教育</td>
<td colspan="1" rowspan="1">计算机硬件组成校验码指令系统存储系统输入／输出技术总线结构</td>
</tr></table>

# 计算机硬件知识点梳理

## 1. 计算机硬件组成

- 计算机的基本硬件系统由**运算器、控制器、存储器、输入设备和输出设备5大部件**组成
- **运算器、控制器等部件被集成在一起统称为中央处理单元（CPU）**
- 存储器是计算机系统中的记忆设备，分为内部存储器和外部存储器
  - 内部存储器：速度高、容量小，一般用于临时存放程序、数据及中间结果
  - 外部存储器：容量大、速度慢，可以长期保存程序和数据
- 输入设备和输出设备合称为外部设备（简称外设）
  - 输入设备：用于输入原始数据及各种命令
  - 输出设备：用于输出计算机运行的结果

**【计算机硬件系统的层次结构：现代计算机系统采用层次化结构设计，从内到外依次是：CPU内部寄存器、Cache、主存储器、外部存储器。这种层次结构设计的目的是平衡速度、容量和成本三者之间的矛盾。越靠近CPU的存储设备速度越快但容量越小、成本越高；越远离CPU的存储设备速度越慢但容量越大、成本越低。】**

## 2. 中央处理单元（CPU）

### CPU的功能

- **程序控制**：CPU通过执行指令来控制程序的执行顺序
- **操作控制**：CPU产生每条指令的操作信号并将操作信号送往对应的部件
- **时间控制**：CPU对各种操作进行时间上的控制
- **数据处理**：CPU通过对数据进行算术运算及逻辑运算等方式进行加工处理
- 对系统内部和外部的中断（异常）做出响应，进行相应的处理

### CPU的组成

- **运算器**：
  - 算术逻辑单元ALU：实现对数据的算术和逻辑运算
  - 累加寄存器AC：运算结果或源操作数的存放区
  - 数据缓冲寄存器DR：暂时存放内存的指令或数据
  - 状态条件寄存器PSW：保存指令运行结果的条件码内容，如溢出标志等
- **控制器**：
  - 指令寄存器IR：暂存CPU执行指令
  - 程序计数器PC：存放指令执行地址
  - 地址寄存器AR：保存当前CPU所访问的内存地址
  - 指令译码器ID：分析指令操作码

**【CPU的工作原理和指令执行过程：CPU执行指令遵循"取指令-分析指令-执行指令"的基本周期。具体过程如下：
1. 取指令阶段：CPU根据PC中的地址从内存中取出指令，放入IR中，同时PC自动加1指向下一条指令
2. 分析指令阶段：指令译码器ID对IR中的指令进行分析，确定指令的类型和操作对象
3. 执行指令阶段：根据指令的要求完成相应的操作，如算术运算、逻辑运算、数据传送等
4. 中断处理阶段：检查是否有中断请求，如有则转入中断处理程序

各种寄存器的具体功能和作用：
- 通用寄存器：用于暂时存放数据，可以存放操作数或地址，数量有限但访问速度快
- 程序计数器PC：存放下一条要执行的指令地址，CPU自动修改其内容以实现顺序执行
- 指令寄存器IR：存放当前正在执行的指令，CPU根据其内容确定操作类型和操作数
- 状态寄存器PSW：存放CPU的状态信息，如进位标志、零标志、溢出标志等
- 地址寄存器AR：存放当前访问的内存地址，用于CPU和内存之间的地址传送
- 数据缓冲寄存器DR：用于CPU和内存之间的数据传送，暂存从内存读出或要写入内存的数据】**

## 3. 校验码

- **码距**：从一个编码转换为另一个编码所需要改变的位数，码距越大越利于纠错和检错
- **奇偶校验码**：
  - 在编码中增加1位校验位使编码中1的个数为奇数（奇校验）或偶数（偶校验），使码距变为2
  - 奇偶校验只能检1位错，不能纠错
- **CRC（循环冗余校验码）**：
  - 只能检错，不能纠错
  - CRC编码过程：
    1. 在原始信息位后添加r个0（r为生成多项式的阶）
    2. 由多项式得到除数
    3. 进行模2除法运算，得到余数
    4. 将余数添加到原始信息后，形成最终发送信息串
    5. 接收方用相同的生成多项式进行校验，余数为0表示无错

**【海明码】：是一种重要的纠错码，能够检测并纠正单比特错误。
- **海明码的构造原理**：在数据位中插入校验位，使得每个校验位负责检查特定位置的数据位
- **海明码的校验位位置**：通常放在2的幂次位置（1, 2, 4, 8...）
- **海明码的纠错能力**：可以纠正1位错误，检测2位错误
- **海明码的最小码距**：为3，因此可以纠正1位错误

**各种校验码的比较**：
| 校验码类型 | 检错能力 | 纠错能力 | 码距             | 应用场景               |
| ---------- | -------- | -------- | ---------------- | ---------------------- |
| 奇偶校验码 | 1位错    | 无       | 2                | 简单通信系统           |
| CRC校验码  | 多位错   | 无       | 取决于生成多项式 | 网络通信、存储系统     |
| 海明码     | 2位错    | 1位错    | 3                | 内存系统、关键数据传输 |

**模2除法**：是一种不进位不借位的二进制除法，相当于异或运算。在CRC计算中，模2除法的步骤如下：
1. 将被除数与除数的最高位对齐
2. 如果被除数的最高位为1，则用除数对被除数进行异或运算；如果为0，则用0对被除数进行异或运算
3. 将异或结果作为新的被除数，重复步骤1和2，直到新的被除数的位数小于除数的位数
4. 最终的被除数即为余数】**

## 4. 指令系统

- **计算机指令的组成**：
  - 操作码：决定要完成的操作
  - 操作数：指参加运算的数据及其所在的单元地址
- **计算机指令执行过程**：取指令→分析指令→执行指令
- **指令寻址方式**：
  - **顺序寻址方式**：一条指令接着一条指令地顺序执行
  - **跳跃寻址方式**：下一条指令的地址码由本条指令直接给出
- **指令操作数的寻址方式**：
  - **立即寻址方式**：指令的地址码字段指出的是操作数本身
  - **直接寻址方式**：指令的地址字段直接指出操作数在主存中的地址
  - **间接寻址方式**：指令地址码字段所指向的存储单元中存储的是操作数的地址
  - **寄存器寻址方式**：指令中的地址码是寄存器的编号
  - **基址寻址方式**：将基址寄存器的内容加上指令中的形式地址形成操作数的有效地址
  - **变址寻址方式**：将变址寄存器的内容加上指令中的形式地址形成操作数的有效地址
- **CISC和RISC的区别**：
  - **CISC（复杂指令系统）**：
    - 指令数量多，使用频率差别大，可变长格式
    - 支持多种寻址方式
    - 微程序控制技术（微码）
    - 研制周期长
  - **RISC（精简指令系统）**：
    - 指令数量少，使用频率接近，定长格式
    - 大部分为单周期指令，操作寄存器，只有Load/Store操作内存
    - 支持方式少
    - 增加了通用寄存器；硬布线逻辑控制为主；适合采用流水线
    - 优化编译，有效支持高级语言
- **指令流水线原理**：将指令分成不同段，每段由不同的部分去处理，产生叠加效果
- **RISC中的流水线技术**：
  - **超流水线**：通过细化流水、增加级数和提高主频，使得在每个机器周期内能完成一个甚至两个浮点操作
  - **超标量**：通过内装多条流水线来同时执行多个处理
  - **超长指令字**：同时执行多条指令，充分发挥软件的作用，而使硬件简化
- **流水线时间计算**：
  - **流水线周期**：指令分成不同执行段，其中执行时间最长的段为流水线周期
  - **流水线执行时间**：1条指令总执行时间＋（总指令条数-1）＊流水线周期
  - **流水线吞吐率**：指令条数／流水线执行时间
  - **流水线加速比**：不使用流水线执行时间／使用流水线执行时间

**【各种寻址方式的优缺点和适用场景】：
| 寻址方式   | 优点                           | 缺点                       | 适用场景               |
| ---------- | ------------------------------ | -------------------------- | ---------------------- |
| 立即寻址   | 不需要访问内存，速度快         | 操作数长度受指令长度限制   | 常数运算               |
| 直接寻址   | 简单，只需一次访存             | 寻址范围受地址字段长度限制 | 访问固定位置的数据     |
| 间接寻址   | 寻址范围大                     | 需要多次访存，速度慢       | 访问指针、引用类型数据 |
| 寄存器寻址 | 速度最快，不需访存             | 寄存器数量有限             | 频繁使用的变量         |
| 基址寻址   | 可实现程序浮动，便于程序重定位 | 计算地址需要额外时间       | 访问数组、结构体       |
| 变址寻址   | 适合处理数组等循环结构         | 计算地址需要额外时间       | 数组处理、循环操作     |

**流水线的冒险问题及解决方法**：
1. **数据冒险**：指令之间存在数据依赖关系，后一条指令需要用到前一条指令的结果
   - 解决方法：数据转发（旁路）、流水线停顿（插入气泡）、编译器优化（指令重排序）
2. **控制冒险**：由分支指令引起，分支指令改变了程序的执行顺序
   - 解决方法：分支预测、延迟分支、分支目标缓冲器
3. **结构冒险**：多条指令在同一时刻争用同一资源
   - 解决方法：资源复制、流水线停顿、指令重排序

**CISC和RISC的发展趋势**：现代处理器设计已经融合了CISC和RISC的优点，如Intel的x86架构采用了CISC指令集，但内部实现采用了RISC的思想，将复杂指令分解为微操作；ARM处理器则保持了RISC的简洁设计，但也增加了一些复杂指令以提高性能。未来处理器设计将继续朝着高性能、低功耗、专用化（如AI加速器）的方向发展。】**

## 5. 存储系统

- **计算机采用分级存储体系**的主要目的是为了解决存储容量、成本和速度之间的矛盾问题
- **两级存储**：Cache-主存、主存-辅存（虚拟存储体系）
- **局部性原理**：
  - **时间局部性原理**：如果一个数据项正在被访问，那么在近期它很可能会被再次访问
  - **空间局部性原理**：在最近的将来会用到的数据的地址和现在正在访问的数据地址很可能是相近的
- **高速缓存Cache**：
  - 用来存储当前最活跃的程序和数据，直接与CPU交互
  - 位于CPU和主存之间，容量小，速度为内存的5-10倍
  - 其内容是主存内存的副本拷贝，对于程序员来说是透明的
- **地址映射**：
  - **直接映像**：主存中的块与Cache中的块的对应关系是固定的，地址变换简单但不灵活
  - **全相联映像**：主存中任意一块都与Cache中任意一块对应，地址变换复杂，速度较慢，最不容易发生块冲突
  - **组组相连映像**：组间采用直接映像，组内全相联映像
- **替换算法**：
  - **随机替换算法**：用随机数发生器产生一个要替换的块号
  - **先进先出算法**：将最先进入Cache的信息块替换出去
  - **近期最少使用算法**：将近期最少使用的Cache中的信息块替换出去
  - **优化替换算法**：先执行一次程序，统计Cache的替换情况，第二次执行时用最有效的方式替换
- **命中率及平均时间**：命中率越高，平均访问时间越短
- **磁盘结构和参数**：
  - 磁盘有正反两个盘面，每个盘面有多个同心圆（磁道），每个磁道被划分为多个扇区
  - 存取时间＝寻道时间＋等待时间（平均定位时间＋转动延迟）
- **磁盘调度算法**：
  - **先来先服务FCFS**：根据进程请求访问磁盘的先后顺序进行调度
  - **最短寻道时间优先SSTF**：请求访问的磁道与当前磁道最近的进程优先调度，可能产生"饥饿"现象
  - **扫描算法SCAN（电梯算法）**：磁头在磁盘上双向移动，选择离磁头当前所在磁道最近且与磁头移动方向一致的请求
  - **单向扫描调度算法CSCAN**：与SCAN不同，只做单向移动

**【虚拟存储技术】：是一种将物理内存和外部存储器（如硬盘）结合使用的技术，使得程序认为它拥有连续的可用内存空间，而实际上这些内存空间可能是分散的、部分存在于外部存储器中的。
- **虚拟存储的基本原理**：将程序的逻辑地址空间分成固定大小的页或可变大小的段，只将当前需要的页或段装入内存，其余部分保留在外存
- **页式虚拟存储**：将逻辑地址空间和物理地址空间分别划分为大小相等的页和页框，通过页表实现映射
- **段式虚拟存储**：按照程序的自然分界（如函数、数据结构）将程序划分为段，每段大小可不同
- **段页式虚拟存储**：结合段式和页式的优点，先将程序分段，再将段分页

**各种Cache替换算法的性能比较**：
| 替换算法          | 优点                           | 缺点                                 | 性能 |
| ----------------- | ------------------------------ | ------------------------------------ | ---- |
| 随机替换          | 实现简单，不需要额外硬件       | 性能不稳定，可能替换频繁使用的块     | 一般 |
| 先进先出(FIFO)    | 实现简单，适合队列结构         | 不考虑访问频率，可能替换频繁使用的块 | 较差 |
| 最近最少使用(LRU) | 考虑时间局部性，性能较好       | 实现复杂，需要记录每块的访问时间     | 较好 |
| 最不经常使用(LFU) | 考虑访问频率，适合某些特定模式 | 实现复杂，需要计数器记录访问次数     | 较好 |
| 优化替换          | 针对特定程序优化，性能最佳     | 需要预先执行程序，不适合通用场景     | 最好 |

**磁盘调度算法的优缺点和适用场景**：
| 调度算法   | 优点                       | 缺点                       | 适用场景                     |
| ---------- | -------------------------- | -------------------------- | ---------------------------- |
| FCFS       | 公平简单，不会产生饥饿     | 平均寻道距离大，效率低     | 负载轻、请求少的系统         |
| SSTF       | 平均寻道距离小，吞吐量大   | 可能产生饥饿现象           | 追求高吞吐量的系统           |
| SCAN(电梯) | 避免饥饿，寻道距离适中     | 对边缘磁道的请求响应时间长 | 负载重的通用系统             |
| CSCAN      | 对所有磁道的响应时间更均衡 | 平均寻道距离比SCAN略大     | 对响应时间均衡性要求高的系统 |

**固态硬盘（SSD）与传统硬盘的区别和特点**：
| 特性         | 固态硬盘(SSD)        | 传统硬盘(HDD)      |
| ------------ | -------------------- | ------------------ |
| 存储介质     | 闪存芯片(NAND Flash) | 磁性盘片           |
| 读写速度     | 快(无机械延迟)       | 慢(受机械部件限制) |
| 随机访问性能 | 极佳                 | 较差               |
| 功耗         | 低                   | 高                 |
| 抗震性       | 强(无机械部件)       | 弱(有机械部件)     |
| 噪音         | 无                   | 有                 |
| 寿命         | 受写入次数限制       | 受机械磨损限制     |
| 成本         | 高                   | 低                 |
| 容量         | 相对较小             | 相对较大           |

SSD不存在传统硬盘的寻道时间和旋转延迟，因此不需要特殊的磁盘调度算法。但SSD有写入次数限制，需要使用磨损均衡(Wear Leveling)技术延长寿命。】**

## 6. 输入输出技术

- **内存与接口地址的编址方法**：
  - **内存与接口地址独立编址方法**：内存地址和接口地址是完全独立的两个地址空间，访问数据时所使用的指令也完全不同
  - **内存与接口地址统一编址方法**：内存地址和接口地址统一在一个公共的地址空间里，用于内存的指令全都可以用于接口
- **计算机和外设间的数据交互方式**：
  - **程序控制（查询）方式**：CPU主动查询外设是否完成数据传输，效率极低
  - **程序中断方式**：外设完成数据传输后，向CPU发送中断，等待CPU处理数据，效率相对较高
  - **DMA方式（直接主存存取）**：CPU只需完成必要的初始化等操作，数据传输的整个过程都由DMA控制器来完成，效率很高
- **CPU响应DMA请求是在一个总线周期结束后，而响应程序中断方式请求是在一条指令执行结束时**

**【中断处理的详细过程】：
1. **中断请求**：外设或其他源向CPU发出中断请求信号
2. **中断响应**：CPU在当前指令执行完毕后检测中断请求，如果允许中断，则响应中断
3. **保存现场**：CPU将当前程序的状态信息（如PC、PSW等）保存到堆栈中
4. **中断服务**：CPU根据中断向量找到中断服务程序的入口地址，并转去执行
5. **恢复现场**：中断服务程序执行完毕后，从堆栈中恢复被中断程序的状态信息
6. **中断返回**：CPU继续执行被中断的程序

**中断优先级**：当多个中断同时发生时，CPU根据中断源的优先级决定先处理哪个中断。一般来说：
- 硬件故障中断（如电源故障）优先级最高
- 时钟中断优先级次之
- I/O设备中断再次之
- 软件中断（如系统调用）优先级最低

**DMA工作原理和控制器结构**：
- **DMA工作原理**：DMA控制器直接控制总线，在内存和I/O设备之间建立直接的数据通路，无需CPU干预
- **DMA传输过程**：
  1. CPU初始化DMA控制器，设置传输方向、起始地址、传输字节数等
  2. CPU继续执行其他任务，DMA控制器接管总线控制权
  3. DMA控制器直接控制内存和I/O设备之间的数据传输
  4. 传输完成后，DMA控制器向CPU发出中断信号
- **DMA控制器结构**：
  - 地址寄存器：存放内存地址
  - 计数器：记录传输的字节数
  - 数据缓冲寄存器：暂存传输的数据
  - 控制逻辑：控制DMA操作
  - 状态寄存器：记录DMA操作状态

**DMA传输方式**：
- **停止CPU访问方式**：DMA传输期间，CPU完全停止工作
- **周期挪用方式**：DMA控制器在CPU不使用总线时获取总线控制权
- **透明DMA方式**：DMA控制器只在CPU访问内部寄存器时才获取总线控制权】**

## 7. 总线结构

- **总线**是连接计算机硬件系统内多种设备的通信线路，由总线上的所有设备共享
- **总线分类**：
  - **内部总线**：内部芯片级别的总线，芯片与处理器之间通信的总线
  - **系统总线**：板级总线，用于计算机内各部分之间的连接，分为数据总线、地址总线、控制总线
  - **外部总线**：设备一级的总线，微机和外部设备的总线，如RS232、SCSI、USB等

**【各种总线标准的特点】：
| 总线标准    | 类型     | 特点                          | 应用场景           |
| ----------- | -------- | ----------------------------- | ------------------ |
| ISA         | 系统总线 | 8/16位，较低速度，插卡式      | 早期PC机扩展卡     |
| PCI         | 系统总线 | 32/64位，高速，即插即用       | 现代PC机内部扩展   |
| PCIe        | 系统总线 | 串行，点对点连接，高速        | 现代PC机高性能扩展 |
| SATA        | 外部总线 | 串行，热插拔，专用于存储设备  | 硬盘、光驱连接     |
| USB         | 外部总线 | 串行，热插拔，通用性强        | 外部设备连接       |
| HDMI        | 外部总线 | 数字视频和音频传输            | 显示设备连接       |
| Thunderbolt | 外部总线 | 结合PCIe和DisplayPort，超高速 | 高性能外设连接     |

**总线的工作方式**：
- **同步方式**：由统一的时钟控制数据传输，所有设备必须在同一时钟下工作
- **异步方式**：没有统一的时钟，通过握手信号控制数据传输
- **半同步方式**：结合同步和异步方式的优点，既有时钟信号，又有握手信号

**总线仲裁方式**：
- **集中式仲裁**：
  - 链式查询：按物理位置顺序决定优先级
  - 计数器定时查询：按计数器的值循环分配总线使用权
  - 独立请求方式：每个设备有独立的请求线和授权线
- **分布式仲裁**：各设备自行决定谁获得总线控制权

**现代计算机系统中的总线发展趋势**：
1. **高速化**：总线频率和带宽不断提高，如PCIe 6.0可达到64GT/s的传输速率
2. **串行化**：从并行总线向串行总线发展，减少干扰，提高传输距离
3. **标准化**：各种总线标准逐渐统一，如USB成为外设连接的主要标准
4. **集成化**：将多种功能集成到一个总线接口，如Thunderbolt集成了数据传输和视频输出
5. **智能化**：总线具有自动配置、错误检测和纠正等功能
6. **低功耗**：新型总线设计更加注重能效，支持动态功耗管理
7. **无线化**：部分传统有线总线被无线技术替代，如Wi-Fi、蓝牙等】** 